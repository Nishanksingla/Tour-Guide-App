<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, height=device-height">
        
        <link rel="stylesheet" href="css/jquery-app-folders.css">
        <link rel="stylesheet" href="css/jquery.mobile-1.4.2.min.css" />
        <link rel="stylesheet" href="css/swipebox.min.css" />
        
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>        
        
        <script src="js/jquery-2.1.0.min.js"></script>
        <script src="js/jquery.mobile-1.4.2.min.js"></script>
        <script src="js/jquery.swipebox.min.js"></script>

        <title>Tour App</title>
        <script type="text/javascript">            
            $(function () {
              $('.swipebox').swipebox();

              var directionsDisplay;
              var directionsService = new google.maps.DirectionsService();
              var map;

              var panoramaOptions = {
                  pano: 'rEQIKH3RXo4AAAGusnEkNQ',
                  pov: {
                      heading: 360,
                      pitch: 10
                  }
              };

              var panorama = new google.maps.StreetViewPanorama(document.getElementById('pano'), panoramaOptions);

              $('.ui-grid-a a').click(function () {
                 debugger
                 if ($(this).attr('data-place') === 'TajMahal') {
                     sessionStorage.panoid = 'rEQIKH3RXo4AAAGusnEkNQ';
                     sessionStorage.place='Taj Mahal, Agra India';
                 } else if ($(this).attr('data-place') === 'LotusTemple') {
                     sessionStorage.panoid = 'WdBZGlAP9jwAAAGu41fwjQ';
                     sessionStorage.place='Lotus Temple, New Delhi India';
                 }
                 $('#menu').show();
                 $('#pano').hide();
              });

             $('#VirtualTour').click(function () {
                 debugger
                 panoramaOptions.pano = sessionStorage.panoid;
                 panorama.setPano(sessionStorage.panoid);
                $('#menu').hide();
                $('#pano').show();
                panorama.setVisible(true);                
                });
             $(document).on("pageshow","#Directions",function(){ // When entering Directions page
                console.log("Directions page shown");
                debugger
                navigator.geolocation.getCurrentPosition(onSuccess,onError,{enableHighAccuracy: true });

                var onSuccess = function(position) {
                  debugger
                  console.log('latitude');
                  console.log(position.coords.latitude);
                  console.log('longitude');
                  console.log(position.coords.longitude);

                  directionsDisplay = new google.maps.DirectionsRenderer();
                  var startPosition = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                  console.log('startPosition');
                  console.log(startPosition);

                  var mapOptions = {
                    zoom:7,
                    center: startPosition
                  }
                  map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
                  directionsDisplay.setMap(map);

                  var request = {
                      origin:startPosition,
                      destination:sessionStorage.place,
                      travelMode: google.maps.TravelMode.DRIVING
                  };

                  directionsService.route(request, function(response, status) {
                    if (status == google.maps.DirectionsStatus.OK) {
                      directionsDisplay.setDirections(response);
                    }else{
                      alert('Error getting route');
                    }
                  });

                }
                
                function onError(error) {
                  alert('code: '    + error.code    + '\n' +
                        'message: ' + error.message + '\n');
                }

              });



            });
                
            </script>       
        <style>
            .box {
                list-style-type: none;
                float: left;
                margin: 10px 10px;
            }
        </style>
    </head>
<body>
  <div data-role="page" id="pagetwo">    
    <div>
        <label style="text-align:center;font-weight:bold;font-size:2em">New Delhi</label>
    </div>
    <div data-role="main" class="ui-content">
        <div class="ui-grid-a">
            <div class="ui-block-a" style="text-align:center;padding: 10px;">
                <a href="#pagethree" data-place="TajMahal"  > 
                <img src="img/TajMahal.jpg" class="ui-corner-all ui-shadow" style="width:100%;height:100%" /> 
                   <figcaption style="text-align:center">Taj Mahal</figcaption>
                </a>
            </div>
            <div class="ui-block-b" style="text-align:center;padding: 10px;">
                <a href="#pagethree" data-place="LotusTemple"  >             
                <img src="img/LotusTemple.JPG" class="ui-corner-all ui-shadow" style="width:100%;height:100%" /> 
                   <figcaption style="text-align:center">Lotus Temple</figcaption>
                </a>
            </div>
        </div>
    </div>    
    <div data-role="footer" data-position="fixed">
        <a href="#pageone" class="ui-btn ui-corner-all ui-shadow ui-btn-icon-left ui-icon-back ui-btn-icon-left">Back</a>      
    </div>
  </div> 

  <div data-role="page" id="pagethree">
      <div data-role="main" class="ui-content" style="min-height:inherit">
          <div id="menu">
          <ul data-role="listview">
              <li><a href="#container" data-panoid="" id="VirtualTour">Virtual Tour</a></li>
              <li><a href="#imageGallery">Image Gallery</a></li>
              <li><a href="#">General Information</a></li>
              <li><a href="#Directions">Directions</a></li>
              <li><a href="#">Reviews</a></li>
              <li><a href="#">Add this place</a></li>
          </ul>
               </div>
         <div id="pano" style="min-height:inherit;display:none">

          </div>
      </div>
      <div data-role="footer" data-position="fixed">
          <a href="#pagetwo" class="ui-btn ui-corner-all ui-shadow ui-btn-icon-left ui-icon-back ui-btn-icon-left">Back</a>
      </div>
  </div>

  <div data-role="page" id="imageGallery">    
      <div data-role="main" class="ui-content">
          <ul style="margin:0;padding:0">
              <li class="box">
                  <a href="img/tajmahal1.jpg" class="swipebox" title="Taj Mahal 1">
                  <img src="img/tajmahal1.jpg" style="width: 100%;" />
                      </a></li>
              <li class="box">
                  <a href="img/tajmahal2.jpg" class="swipebox" title="Taj Mahal 2">
                  <img src="img/tajmahal2.jpg" style="width: 100%;" />
                      </a>
              </li>
              <li class="box">
                  <a href="img/tajmahal3.jpg" class="swipebox" title="Taj Mahal 3">
                  <img src="img/tajmahal3.jpg" style="width: 100%;" />
                      </a>
              </li>
              <li class="box">
                  <a href="img/tajmahal4.jpg" class="swipebox" title="Taj Mahal 4">
                  <img src="img/tajmahal4.jpg" style="width: 100%;" />
                      </a>
              </li>
          </ul>
      </div>
      <div data-role="footer" data-position="fixed">
          <a href="#pagethree" class="ui-btn ui-corner-all ui-shadow ui-btn-icon-left ui-icon-back ui-btn-icon-left" data-transition="slide" data-direction="reverse">Back</a>
      </div>
  </div>

  <div data-role="page" id="Directions">
    <div data-role="main" class="ui-content" style="min-height:calc(100% - 30px)">
      <div id="map-canvas"></div>
    </div>
    <div data-role="footer" data-position="fixed">
      <a href="#pagethree" class="ui-btn ui-corner-all ui-shadow ui-btn-icon-left ui-icon-back ui-btn-icon-left">Back</a>
    </div>
  </div>
   
</body>
     
</html>
